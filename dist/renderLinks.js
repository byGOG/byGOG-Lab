export async function fetchLinks(){const e=await fetch("links.json");if(!e.ok)throw new Error("links.json yüklenemedi");return e.json()}function createLinkItem(e){const t=document.createElement("li"),n=document.createElement("a");if(n.href=e.url,n.target="_blank",e.recommended){const e=document.createElement("span");e.className="star",e.title="Önerilen",e.textContent="★",n.appendChild(e)}let o;if(e.icon){o=document.createElement("span"),o.className="icon-wrapper";const t=document.createElement("img");t.loading="lazy",t.src=e.icon,e.alt&&(t.alt=e.alt),t.className="site-icon",o.appendChild(t),n.appendChild(o)}const c=document.createElement("span");if(c.className="link-text",c.textContent=e.name,n.appendChild(c),e.description){const t=document.createElement("span");if(t.className="custom-tooltip",e.icon){const n=document.createElement("img");n.loading="lazy",n.src=e.icon,e.alt&&(n.alt=e.alt),t.appendChild(n)}t.appendChild(document.createTextNode(e.description)),n.appendChild(t)}return t.appendChild(n),t}function renderCategories(e,t){const n=document.createDocumentFragment();e.categories.forEach(e=>{const t=document.createElement("div");t.className="category-card";const o=document.createElement("h2");if(o.textContent=e.title,t.appendChild(o),e.subcategories){const n=document.createElement("div");n.className="sub-category-container",e.subcategories.forEach(e=>{const t=document.createElement("div");t.className="sub-category";const o=document.createElement("h3");o.textContent=e.title,t.appendChild(o);const c=document.createElement("ul");e.links.forEach(e=>c.appendChild(createLinkItem(e))),t.appendChild(c),n.appendChild(t)}),t.appendChild(n)}else if(e.links){const n=document.createElement("ul");e.links.forEach(e=>n.appendChild(createLinkItem(e))),t.appendChild(n)}n.appendChild(t)}),t.appendChild(n)}function setupSearch(){const e=document.getElementById("search-input"),t=document.getElementById("search-status"),n=Array.from(document.querySelectorAll(".category-card li")),o=n.map(e=>e.textContent.toLowerCase());let c;function a(){const c=e.value.toLowerCase().trim();let a=0;n.forEach((e,t)=>{const n=o[t].includes(c);e.style.display=n?"":"none",n&&a++}),document.querySelectorAll(".category-card").forEach(e=>{const t=e.querySelectorAll(".sub-category");if(t.length){let n=!1;t.forEach(e=>{const t=e.querySelectorAll('li:not([style*="display: none"])').length>0;e.style.display=t?"":"none",t&&(n=!0)}),e.style.display=n?"":"none"}else{const t=e.querySelectorAll('li:not([style*="display: none"])');e.style.display=t.length>0?"":"none"}}),t.textContent=c?`${a} sonuç bulundu`:""}e.addEventListener("input",()=>{clearTimeout(c),c=setTimeout(a,300)})}function setupThemeToggle(){const e=document.getElementById("theme-toggle"),t=document.body,n=window.matchMedia("(prefers-color-scheme: dark)");function o(n){n?(t.classList.add("koyu"),e.textContent="☀️"):(t.classList.remove("koyu"),e.textContent="🌙")}e.addEventListener("click",()=>{const e=!t.classList.contains("koyu");o(e),localStorage.setItem("theme",e?"koyu":"aydinlik")});let c=localStorage.getItem("theme");c||(c=n.matches?"koyu":"aydinlik"),o("koyu"===c),n.addEventListener("change",e=>{localStorage.getItem("theme")||o(e.matches)})}document.addEventListener("DOMContentLoaded",async()=>{setupThemeToggle();const e=document.getElementById("links-container");try{renderCategories(await fetchLinks(),e)}catch(t){e.textContent="Bağlantılar yüklenemedi.",console.error(t)}setupSearch()});
