export async function fetchLinks(){const e=await fetch("links.json");if(!e.ok)throw new Error("links.json yüklenemedi");return e.json()}function createLinkItem(e){const t=document.createElement("li"),n=document.createElement("a");if(n.href=e.url,n.target="_blank",e.recommended){const e=document.createElement("span");e.className="star",e.title="Önerilen",e.textContent="★",n.appendChild(e)}let a;if(e.icon){a=document.createElement("span"),a.className="icon-wrapper";const t=document.createElement("img");t.loading="lazy",t.src=e.icon,e.alt&&(t.alt=e.alt),t.className="site-icon",a.appendChild(t),n.appendChild(a)}const l=document.createElement("span");if(l.className="link-text",l.textContent=normalizeText(e.name),n.appendChild(l),e.description){const t=document.createElement("span");if(t.className="custom-tooltip",e.icon){const n=document.createElement("img");n.loading="lazy",n.src=e.icon,e.alt&&(n.alt=e.alt),t.appendChild(n)}t.appendChild(document.createTextNode(normalizeText(e.description))),n.appendChild(t)}return t.appendChild(n),t}function renderCategories(e,t){const n=document.createDocumentFragment();e.categories.forEach(e=>{const t=document.createElement("div");t.className="category-card";const a=document.createElement("h2");if(a.textContent=normalizeText(e.title),t.appendChild(a),e.subcategories){const n=document.createElement("div");n.className="sub-category-container",e.subcategories.forEach(e=>{const t=document.createElement("div");t.className="sub-category";const a=document.createElement("h3");a.textContent=normalizeText(e.title),t.appendChild(a);const l=document.createElement("ul");e.links.forEach(e=>l.appendChild(createLinkItem(e))),t.appendChild(l),n.appendChild(t)}),t.appendChild(n)}else if(e.links){const n=document.createElement("ul");e.links.forEach(e=>n.appendChild(createLinkItem(e))),t.appendChild(n)}n.appendChild(t)}),t.appendChild(n)}function setupSearch(){const e=document.getElementById("search-input"),t=document.getElementById("search-status"),n=Array.from(document.querySelectorAll(".category-card li")),a=n.map(e=>e.textContent.toLowerCase());let l;function o(){const l=e.value.toLowerCase().trim();let o=0;n.forEach((e,t)=>{const n=a[t].includes(l);e.style.display=n?"":"none",n&&o++}),document.querySelectorAll(".category-card").forEach(e=>{const t=e.querySelectorAll(".sub-category");if(t.length){let n=!1;t.forEach(e=>{const t=e.querySelectorAll('li:not([style*="display: none"])').length>0;e.style.display=t?"":"none",t&&(n=!0)}),e.style.display=n?"":"none"}else{const t=e.querySelectorAll('li:not([style*="display: none"])');e.style.display=t.length>0?"":"none"}}),t.textContent=l?`${o} sonuç bulundu`:""}e.addEventListener("input",()=>{clearTimeout(l),l=setTimeout(o,300)})}function setupThemeToggle(){const e=document.getElementById("theme-toggle"),t=document.body,n=window.matchMedia("(prefers-color-scheme: dark)");function a(n){n?(t.classList.add("koyu"),e.textContent="☀️"):(t.classList.remove("koyu"),e.textContent="🌙")}e.addEventListener("click",()=>{const e=!t.classList.contains("koyu");a(e),localStorage.setItem("theme",e?"koyu":"aydinlik")});let l=localStorage.getItem("theme");l||(l=n.matches?"koyu":"aydinlik"),a("koyu"===l),n.addEventListener("change",e=>{localStorage.getItem("theme")||a(e.matches)})}function normalizeText(e){if(!e)return e;const t=[["�nerilenler","Önerilenler"],["�nerilen","Önerilen"],["Windows �ndirme","Windows İndirme"],[" �ndir"," İndir"],["�zel","Özel"],["Linux Da��t�mlar�","Linux Dağıtımları"],["da��t�mlar�ndan","dağıtımlarından"],["da��t�mlar�","dağıtımları"],["da��t�m�","dağıtımı"],["da��t�m","dağıtım"],["s�r�m�","sürümü"],["s�r�m","sürüm"],["g�venlik","güvenlik"],["Ara�lar�","Araçları"],["ara�lar�","araçları"],["ara�lar","araçlar"],["ara�","araç"],["kullan�c�","kullanıcı"],["pop�lerlik","popülerlik"],["pop�ler","popüler"],["i�in","için"],["i�erik","içerik"],["i�letim","işletim"],["�oklu","çoklu"],["�ny�kleme","önyükleme"],["ba�lant�lar","bağlantılar"],["ba�lant�","bağlantı"],["dosyas�","dosyası"],["olu�turma","oluşturma"],["g�ncelleme","güncelleme"],["Optimize edilmi�","Optimize edilmiş"],["odakl�","odaklı"],["hakk�nda","hakkında"],["di�er","diğer"],["sa�layan","sağlayan"],["Donan�m","Donanım"],["donan�m","donanım"],["tan�mlama","tanımlama"],["detayl�","detaylı"]];let n=e;for(const[e,a]of t)n=n.replaceAll(e,a);return n}document.addEventListener("DOMContentLoaded",async()=>{setupThemeToggle();const e=document.getElementById("links-container");try{renderCategories(await fetchLinks(),e)}catch(t){e.textContent="Bağlantılar yüklenemedi.",console.error(t)}setupSearch(),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("sw.js").then(e=>{console.log("ServiceWorker registration successful with scope: ",e.scope)},e=>{console.log("ServiceWorker registration failed: ",e)})})});
