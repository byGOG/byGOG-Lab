export async function fetchLinks(){const e=await fetch("links.json");if(!e.ok)throw new Error("links.json yüklenemedi");return e.json()}function createLinkItem(e){const t=document.createElement("li"),n=document.createElement("a");if(n.href=e.url,n.target="_blank",e.recommended){const e=document.createElement("span");e.className="star",e.title="Önerilen",e.textContent="★",n.appendChild(e)}let a;if(e.icon){a=document.createElement("span"),a.className="icon-wrapper";const t=document.createElement("img");t.loading="lazy",t.src=e.icon,e.alt&&(t.alt=e.alt),t.className="site-icon",a.appendChild(t),n.appendChild(a)}const o=document.createElement("span");if(o.className="link-text",o.textContent=e.name,n.appendChild(o),e.description){const t=document.createElement("span");if(t.className="custom-tooltip",e.icon){const n=document.createElement("img");n.loading="lazy",n.src=e.icon,e.alt&&(n.alt=e.alt),t.appendChild(n)}t.appendChild(document.createTextNode(e.description)),n.appendChild(t)}return t.appendChild(n),t}function renderCategories(e,t){const n=document.createDocumentFragment();e.categories.forEach(e=>{const t=document.createElement("div");t.className="category-card";const a=document.createElement("h2");if(a.textContent=e.title,t.appendChild(a),e.subcategories){const n=document.createElement("div");n.className="sub-category-container",e.subcategories.forEach(e=>{const t=document.createElement("div");t.className="sub-category";const a=document.createElement("h3");a.textContent=e.title,t.appendChild(a);const o=document.createElement("ul");e.links.forEach(e=>o.appendChild(createLinkItem(e))),t.appendChild(o),n.appendChild(t)}),t.appendChild(n)}else if(e.links){const n=document.createElement("ul");e.links.forEach(e=>n.appendChild(createLinkItem(e))),t.appendChild(n)}n.appendChild(t)}),t.appendChild(n)}function setupSearch(){const e=document.getElementById("search-input"),t=document.getElementById("search-status"),n=Array.from(document.querySelectorAll(".category-card li")),a=n.map(e=>e.textContent.toLowerCase());let o;function c(){const o=e.value.toLowerCase().trim();let c=0;n.forEach((e,t)=>{const n=a[t].includes(o);e.style.display=n?"":"none",n&&c++}),document.querySelectorAll(".category-card").forEach(e=>{const t=e.querySelectorAll(".sub-category");if(t.length){let n=!1;t.forEach(e=>{const t=e.querySelectorAll('li:not([style*="display: none"])').length>0;e.style.display=t?"":"none",t&&(n=!0)}),e.style.display=n?"":"none"}else{const t=e.querySelectorAll('li:not([style*="display: none"])');e.style.display=t.length>0?"":"none"}}),t.textContent=o?`${c} sonuç bulundu`:"",t.setAttribute("aria-live",o?"polite":"off")}e.addEventListener("input",()=>{clearTimeout(o),o=setTimeout(c,300)})}function setupThemeToggle(){const e=document.getElementById("theme-toggle"),t=document.body,n=window.matchMedia("(prefers-color-scheme: dark)");function a(n){n?(t.classList.add("koyu"),e.textContent="☀️"):(t.classList.remove("koyu"),e.textContent="🌙")}e.addEventListener("click",()=>{const e=!t.classList.contains("koyu");a(e),localStorage.setItem("theme",e?"koyu":"aydinlik")});let o=localStorage.getItem("theme");o||(o=n.matches?"koyu":"aydinlik"),a("koyu"===o),n.addEventListener("change",e=>{localStorage.getItem("theme")||a(e.matches)})}document.addEventListener("DOMContentLoaded",async()=>{setupThemeToggle();const e=document.getElementById("links-container");try{renderCategories(await fetchLinks(),e)}catch(t){e.textContent="Bağlantılar yüklenemedi. Lütfen sayfayı yenileyin.",console.error("Bağlantılar yüklenirken hata:",t)}setupSearch()});
